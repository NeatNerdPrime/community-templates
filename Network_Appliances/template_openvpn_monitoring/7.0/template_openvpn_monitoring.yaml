zabbix_export:
  version: '7.0'
  template_groups:
    - uuid: 2169c55e9a40463eb518d16faa2fc9af
      name: 'Templates Users'
  templates:
    - uuid: 3ec16411253e496985ec7481d8cd764f
      template: 'Template App OpenVPN Service'
      name: 'OpenVPN by Zabbix Agent 2'
      groups:
        - name: 'Templates Users'
      items:
        - uuid: a6b7123e35fd46d181c8e4b7ca4cb5e8
          name: 'Openvpn user number'
          key: openvpn.user.number.new
          history: 90d
          units: count
          tags:
            - tag: application
              value: vpn
            - tag: component
              value: openvpn
        - uuid: 448cf0860818402f94ebd72996312124
          name: 'Openvpn version'
          key: openvpn.version
          delay: 1h
          history: 90d
          value_type: CHAR
          trends: '0'
          tags:
            - tag: application
              value: vpn
            - tag: component
              value: openvpn
          triggers:
            - uuid: 33360c5d61e74825aa0d3072f4846003
              expression: '(last(/Template App OpenVPN Service/openvpn.version,#1)<>last(/Template App OpenVPN Service/openvpn.version,#2))=1'
              name: 'Version of openvpn was changed on {HOST.NAME}'
              priority: INFO
        - uuid: eff884ef29654760b4741324398139f1
          name: 'Openvpn service is running'
          key: 'proc.num[openvpn]'
          history: 90d
          tags:
            - tag: application
              value: vpn
            - tag: component
              value: openvpn
          triggers:
            - uuid: a525b0c2ab9f4c0ca3d2f60af3cd4973
              expression: 'last(/Template App OpenVPN Service/proc.num[openvpn])=0'
              name: 'Openvpn service is down on {HOST.NAME}'
              priority: WARNING
        - uuid: 7f8e9d1c3b2a4567890abcdef1234567
          name: 'OpenVPN authentication failures (24h)'
          key: openvpn.auth_failures
          history: 30d
          units: failures
          tags:
            - tag: application
              value: vpn
            - tag: component
              value: openvpn
            - tag: security
              value: authentication
          triggers:
            - uuid: ecec2f8a2f36486d8b5942b230386a3a
              expression: 'last(/Template App OpenVPN Service/openvpn.auth_failures)>10'
              name: 'OpenVPN: High authentication failure rate on {HOST.NAME}'
              priority: WARNING
              description: 'More than 10 authentication failures detected in last 24 hours'
        - uuid: 34a1b01b39d645619bccce0d794c3447
          name: 'OpenVPN reconnections (24h)'
          key: openvpn.reconnections
          history: 30d
          units: reconnections
          tags:
            - tag: application
              value: vpn
            - tag: component
              value: openvpn
            - tag: stability
              value: connections
          triggers:
            - uuid: c231737f1ec54b939de562cbe531365e
              expression: 'last(/Template App OpenVPN Service/openvpn.reconnections)>20'
              name: 'OpenVPN: High reconnection rate on {HOST.NAME}'
              priority: WARNING
              description: 'More than 20 reconnections detected in last 24 hours'
      discovery_rules:
        - uuid: 62962721b7f7411eb8265bac414104b6
          name: 'Openvpn users discovery'
          key: openvpn.discovery
          delay: 10m
          lifetime: 30d
          enabled_lifetime_type: DISABLE_NEVER
          item_prototypes:
            - uuid: f809d88305ef4ad090a143bfbabac940
              name: 'Openvpn byte received {#VPN.USER}'
              key: 'openvpn.user.received.new[{#VPN.USER}]'
              units: b\s
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: application
                  value: vpn
                - tag: component
                  value: openvpn
            - uuid: ff5658bf12704e45819dedb97ddd59a0
              name: 'Openvpn byte sent {#VPN.USER}'
              key: 'openvpn.user.sent.new[{#VPN.USER}]'
              units: b\s
              preprocessing:
                - type: CHANGE_PER_SECOND
                  parameters:
                    - ''
              tags:
                - tag: application
                  value: vpn
                - tag: component
                  value: openvpn
            - uuid: 3183cc38de4b457e8be3e9332ef912cd
              name: 'Openvpn user status {#VPN.USER}'
              key: 'openvpn.user.status.new[{#VPN.USER}]'
              tags:
                - tag: application
                  value: vpn
                - tag: component
                  value: openvpn
            - uuid: 4294cd49e7f54f76a4e5c1b6ca5dc8e9
              name: 'OpenVPN connection duration {#VPN.USER}'
              key: 'openvpn.user.duration.new[{#VPN.USER}]'
              units: s
              tags:
                - tag: application
                  value: vpn
                - tag: component
                  value: openvpn
                - tag: metric
                  value: duration
            - uuid: 5305de5af8064687b5f6d2c7db6ed9fa
              name: 'OpenVPN real IP address {#VPN.USER}'
              key: 'openvpn.user.real_address.new[{#VPN.USER}]'
              value_type: TEXT
              trends: '0'
              tags:
                - tag: application
                  value: vpn
                - tag: component
                  value: openvpn
                - tag: info
                  value: address
            - uuid: 44d59a3ed7814034a1572de55941123d
              name: 'OpenVPN virtual IP address {#VPN.USER}'
              key: 'openvpn.user.virtual_address.new[{#VPN.USER}]'
              value_type: TEXT
              trends: '0'
              tags:
                - tag: application
                  value: vpn
                - tag: component
                  value: openvpn
                - tag: info
                  value: address
          graph_prototypes:
            - uuid: 990427961fce4e59ae8995915552153a
              name: 'Openvpn byte sent/received {#VPN.USER}'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Template App OpenVPN Service'
                    key: 'openvpn.user.received.new[{#VPN.USER}]'
                - sortorder: '2'
                  color: F63100
                  item:
                    host: 'Template App OpenVPN Service'
                    key: 'openvpn.user.sent.new[{#VPN.USER}]'
            - uuid: d2e961d1932441e2bd4e54dc41b0643d
              name: 'Openvpn status {#VPN.USER}'
              graph_items:
                - sortorder: '1'
                  color: 1A7C11
                  item:
                    host: 'Template App OpenVPN Service'
                    key: 'openvpn.user.status.new[{#VPN.USER}]'
            - uuid: 141ecf232f2c461d86daba5973db32fe
              name: 'OpenVPN connection duration {#VPN.USER}'
              graph_items:
                - sortorder: '1'
                  color: 0080FF
                  item:
                    host: 'Template App OpenVPN Service'
                    key: 'openvpn.user.duration.new[{#VPN.USER}]'
  graphs:
    - uuid: 8622c33c2c1f4a1d91b038c6659a5527
      name: 'Openvpn status of all users'
      graph_items:
        - color: 0040FF
          item:
            host: 'Template App OpenVPN Service'
            key: openvpn.user.number.new
